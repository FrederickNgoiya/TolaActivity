(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{LBcr:function(e,t,r){"use strict";r.d(t,"a",function(){return a}),r.d(t,"b",function(){return c}),r.d(t,"c",function(){return l});var n=window.userLang,o="numeric",i={year:o,month:"short",day:o};function a(e){return new Date(e)}function c(e){var t=e.split("-").map(function(e){return parseInt(e)});return new Date(t[0],t[1]-1,t[2])}function l(e){return new Intl.DateTimeFormat(n,i).format(e)}},Wr7D:function(e,t,r){"use strict";r.r(t);var n,o,i,a,c=r("q1tI"),l=r.n(c),d=r("i8i4"),u=r.n(d),s=r("wgi2"),m=r("0pHI"),p=r("qtBC"),f=(r("TSYQ"),r("okNM")),b=r("QL2g"),I=r.n(b),h=r("FoaG"),g=r.n(h),y=r("y2Vs"),S=r("LBcr");function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function j(e,t,r){return t&&w(e.prototype,t),r&&w(e,r),e}function D(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?k(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e,t){var r=e.documents;if(t.selectedProgramId&&(r=r.filter(function(e){return e.program===t.selectedProgramId})),t.selectedProjectId&&(r=r.filter(function(e){return e.project&&e.project.id===t.selectedProjectId})),t.selectedIndicatorId){var n=new Set(e.getDocumentsForIndicator(t.selectedIndicatorId));r=r.filter(function(e){return n.has(e.id)})}return r}var C,z,F,N,T,A,M,R,q,B,L=Object(f.c)(n=function(e){function r(e){var t;return P(this,r),(t=D(this,O(r).call(this,e))).onSelection=t.onSelection.bind(k(k(t))),t}return _(r,l.a.Component),j(r,[{key:"onSelection",value:function(e){var t=e?e.value:null;p.a.emit("program-id-filter-selected",t)}},{key:"render",value:function(){var e=this.props,t=e.rootStore,r=e.uiStore,n=t.programs,o=r.selectedProgramId,i=n.map(function(e){return{value:e.id,label:e.name}}),a=null;return o&&(a=i.find(function(e){return e.value===o})),l.a.createElement(y.default,{options:i,value:a,isClearable:!0,placeholder:gettext("Filter by program"),onChange:this.onSelection})}}]),r}())||n,H=Object(f.c)(o=function(e){function r(e){var t;return P(this,r),(t=D(this,O(r).call(this,e))).onSelection=t.onSelection.bind(k(k(t))),t}return _(r,l.a.Component),j(r,[{key:"onSelection",value:function(e){var t=e?e.value:null;p.a.emit("indicator-id-filter-selected",t)}},{key:"render",value:function(){var e=this.props,t=e.rootStore,r=e.uiStore,n=r.selectedProgramId,o=r.selectedIndicatorId,i=[];n&&(i=t.getIndicators(n).map(function(e){return{value:e.id,label:e.number?e.number+" "+e.name:e.name}}));var a=null;o&&(a=i.find(function(e){return e.value===o}));var c=void 0;return n||(c=!1),l.a.createElement(y.default,{isDisabled:!n,options:i,value:a,isClearable:!0,placeholder:gettext("Filter by indicator"),onChange:this.onSelection,menuIsOpen:c})}}]),r}())||o,J=Object(f.c)(i=function(e){function r(e){var t;return P(this,r),(t=D(this,O(r).call(this,e))).onSelection=t.onSelection.bind(k(k(t))),t}return _(r,l.a.Component),j(r,[{key:"onSelection",value:function(e){var t=e?e.value:null;p.a.emit("document-id-filter-selected",t)}},{key:"render",value:function(){var e=this.props,t=e.rootStore,r=e.uiStore,n=x(t,r),o=r.selectedDocumentId,i=n.map(function(e){return{value:e.id,label:e.name}}),a=null;return o&&(a=i.find(function(e){return e.value===o})),l.a.createElement(y.default,{options:i,value:a,isClearable:!0,placeholder:gettext("Find a document"),onChange:this.onSelection})}}]),r}())||i,Q=Object(f.c)(a=function(e){function t(){return P(this,t),D(this,O(t).apply(this,arguments))}return _(t,l.a.Component),j(t,[{key:"render",value:function(){var e=this.props,t=e.rootStore,r=e.uiStore;return l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-3"},l.a.createElement(L,{rootStore:t,uiStore:r})),l.a.createElement("div",{className:"col-3"},l.a.createElement(H,{rootStore:t,uiStore:r})),l.a.createElement("div",{className:"col-3"},l.a.createElement(J,{rootStore:t,uiStore:r})),l.a.createElement("div",{className:"col-3 text-right"},l.a.createElement("a",{href:"/workflow/documentation_add",className:"btn btn-link btn-add"},l.a.createElement("i",{className:"fas fa-plus-circle"})," ",gettext("Add document"))))}}]),t}())||a,W=Object(f.c)(function(e){var t=e.rootStore,r=e.uiStore,n=x(t,r);if(r.selectedDocumentId&&(n=n.filter(function(e){return e.id===r.selectedDocumentId})),0===n.length)return l.a.createElement("div",null,l.a.createElement("span",null,"No documents available"));var o=[{dataField:"name",text:gettext("Document"),sort:!0,formatter:function(e,t){return l.a.createElement("a",{href:t.url,target:"_blank"},t.name)}},{dataField:"create_date",text:gettext("Date added"),sort:!0,formatter:function(e,t){return l.a.createElement("span",null,Object(S.c)(Object(S.a)(t.create_date)))}},{dataField:"project.project_name",text:gettext("Project"),hidden:!t.allowProjectsAccess},{dataField:"actions",isDummyField:!0,text:"",align:"right",formatter:function(e,t){return l.a.createElement("div",{className:"text-nowrap"},l.a.createElement("a",{href:"/workflow/documentation_delete/"+t.id,className:"btn p-0 pr-4 btn-sm btn-text text-danger"},l.a.createElement("i",{className:"fas fa-trash-alt"})," ",gettext("Delete")),l.a.createElement("a",{href:"/workflow/documentation_update/"+t.id,className:"btn p-0 btn-sm btn-text"},l.a.createElement("i",{className:"fas fa-edit"})," ",gettext("Edit")))}}],i={sizePerPage:50,showTotal:!0,paginationTotalRenderer:function(e,t,r){var n=interpolate(gettext("Showing rows %(fromCount)s to %(toCount)s of %(totalCount)s"),{fromCount:e,toCount:t,totalCount:r},!0);return l.a.createElement("span",{className:"react-bootstrap-table-pagination-total"}," ",n)}};return l.a.createElement(I.a,{keyField:"id",data:n,columns:o,bootstrap4:!0,pagination:g()(i),defaultSorted:[{dataField:"create_date",order:"desc"}]})}),G=Object(f.c)(function(e){var t=e.rootStore,r=e.uiStore;return l.a.createElement(l.a.Fragment,null,l.a.createElement(Q,{rootStore:t,uiStore:r}),l.a.createElement("br",null),l.a.createElement(W,{rootStore:t,uiStore:r}))}),V=r("2vnA");function Y(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function X(e,t,r){return t&&U(e.prototype,t),r&&U(e,r),e}function Z(r,n,e,t,o){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(r,n,e)||e},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(r,n,i),i=null),i}var $=(z=Z((C=function(){function o(e,t,r,n){K(this,o),Y(this,"documents",z,this),Y(this,"programs",F,this),Y(this,"indicatorToDocumentsMap",N,this),Y(this,"allowProjectsAccess",T,this),this.documents=e,this.programs=t,this.indicatorToDocumentsMap=r,this.allowProjectsAccess=n,this.getIndicators=this.getIndicators.bind(this),this.getDocumentsForIndicator=this.getDocumentsForIndicator.bind(this)}return X(o,[{key:"getIndicators",value:function(t){var e=this.programs.filter(function(e){return e.id===t});return e.length?e[0].indicator_set:[]}},{key:"getDocumentsForIndicator",value:function(e){return this.indicatorToDocumentsMap[e]}}]),o}()).prototype,"documents",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=Z(C.prototype,"programs",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),N=Z(C.prototype,"indicatorToDocumentsMap",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),T=Z(C.prototype,"allowProjectsAccess",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),C),ee=(M=Z((A=function(){function e(){K(this,e),Y(this,"selectedProgramId",M,this),Y(this,"selectedIndicatorId",R,this),Y(this,"selectedDocumentId",q,this),Y(this,"selectedProjectId",B,this),this.setSelectedProgramId=this.setSelectedProgramId.bind(this),this.clearSelectedProgramId=this.clearSelectedProgramId.bind(this),this.setSelectedIndicatorId=this.setSelectedIndicatorId.bind(this),this.clearSelectedIndicatorId=this.clearSelectedIndicatorId.bind(this),this.setSelectedDocumentId=this.setSelectedDocumentId.bind(this),this.clearSelectedDocumentId=this.clearSelectedDocumentId.bind(this),this.setSelectedProjectId=this.setSelectedProjectId.bind(this),this.clearSelectedProjectId=this.clearSelectedProjectId.bind(this)}return X(e,[{key:"setSelectedProgramId",value:function(e){this.selectedProgramId=e}},{key:"clearSelectedProgramId",value:function(){this.selectedProgramId=null}},{key:"setSelectedIndicatorId",value:function(e){this.selectedIndicatorId=e}},{key:"clearSelectedIndicatorId",value:function(){this.selectedIndicatorId=null}},{key:"setSelectedDocumentId",value:function(e){this.selectedDocumentId=e}},{key:"clearSelectedDocumentId",value:function(){this.selectedDocumentId=null}},{key:"setSelectedProjectId",value:function(e){this.selectedProjectId=e}},{key:"clearSelectedProjectId",value:function(){this.selectedProjectId=null}}]),e}()).prototype,"selectedProgramId",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=Z(A.prototype,"selectedIndicatorId",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q=Z(A.prototype,"selectedDocumentId",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=Z(A.prototype,"selectedProjectId",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z(A.prototype,"setSelectedProgramId",[V.d],Object.getOwnPropertyDescriptor(A.prototype,"setSelectedProgramId"),A.prototype),Z(A.prototype,"clearSelectedProgramId",[V.d],Object.getOwnPropertyDescriptor(A.prototype,"clearSelectedProgramId"),A.prototype),Z(A.prototype,"setSelectedIndicatorId",[V.d],Object.getOwnPropertyDescriptor(A.prototype,"setSelectedIndicatorId"),A.prototype),Z(A.prototype,"clearSelectedIndicatorId",[V.d],Object.getOwnPropertyDescriptor(A.prototype,"clearSelectedIndicatorId"),A.prototype),Z(A.prototype,"setSelectedDocumentId",[V.d],Object.getOwnPropertyDescriptor(A.prototype,"setSelectedDocumentId"),A.prototype),Z(A.prototype,"clearSelectedDocumentId",[V.d],Object.getOwnPropertyDescriptor(A.prototype,"clearSelectedDocumentId"),A.prototype),Z(A.prototype,"setSelectedProjectId",[V.d],Object.getOwnPropertyDescriptor(A.prototype,"setSelectedProjectId"),A.prototype),Z(A.prototype,"clearSelectedProjectId",[V.d],Object.getOwnPropertyDescriptor(A.prototype,"clearSelectedProjectId"),A.prototype),A),te=jsContext,re=new $(te.documents,te.programs,te.indicatorToDocumentsMap,te.allowProjectsAccess),ne=new ee;var oe=Object(s.b)([{name:"documents",path:"/?program_id&project_id&indicator_id&document_id"}],{defaultRoute:"all",defaultParams:{}});oe.usePlugin(Object(m.a)({useHash:!1,base:"/workflow/documentation_list"})),oe.subscribe(function(e){e.previousRoute;var t=e.route.params;t.indicator_id?ne.setSelectedIndicatorId(parseInt(t.indicator_id)):ne.clearSelectedIndicatorId(),t.program_id?ne.setSelectedProgramId(parseInt(t.program_id)):(ne.clearSelectedProgramId(),ne.clearSelectedIndicatorId()),t.document_id?ne.setSelectedDocumentId(parseInt(t.document_id)):ne.clearSelectedDocumentId(),t.project_id?ne.setSelectedProjectId(parseInt(t.project_id)):ne.clearSelectedProjectId()}),oe.start(),p.a.on("program-id-filter-selected",function(e){e?oe.navigate("documents",{program_id:e}):oe.navigate("documents")}),p.a.on("indicator-id-filter-selected",function(e){var t=ne.selectedProgramId;e?oe.navigate("documents",{program_id:t,indicator_id:e}):oe.navigate("documents",{program_id:t})}),p.a.on("document-id-filter-selected",function(e){var t=ne.selectedProgramId,r=ne.selectedIndicatorId,n={};t&&(n.program_id=t),r&&(n.indicator_id=r),e&&(n.document_id=e),oe.navigate("documents",n)}),u.a.render(l.a.createElement(G,{rootStore:re,uiStore:ne}),document.querySelector("#documents-view"))},qtBC:function(e,t,r){"use strict";var n=r("7+Rn"),o=r.n(n)()();t.a=o}},[["Wr7D",0,1]]]);