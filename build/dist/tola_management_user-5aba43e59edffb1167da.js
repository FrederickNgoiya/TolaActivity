(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"5Xg7":function(e,t,r){"use strict";r.d(t,"a",function(){return f});var n=r("q1tI"),s=r.n(n),c=r("c7k8"),a=r("y2Vs");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=u(this,p(r).call(this,e))).cache=new c.c({fixedWidth:!0,defaultHeight:35}),t.filter_val="",t}var t,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(r,s.a.PureComponent),t=r,(n=[{key:"render",value:function(){var i=this,e=this.props,o=(e.options,e.children),t=e.maxHeight,r=(e.getValue,e.selectProps),n=o.length||0;return r.inputValue!==this.filter_val&&(this.filter_val=r.inputValue,this.cache.clearAll()),s.a.createElement("div",{style:{display:"flex",height:"100vh",maxHeight:t+"px"}},s.a.createElement("div",{style:{flex:"1 1 auto"}},s.a.createElement(c.a,null,function(e){var t=e.width,r=e.height;return s.a.createElement(c.e,{height:r,width:t,deferredMeasurementCache:i.cache,rowCount:n,rowHeight:i.cache.rowHeight,noRowsRenderer:function(){return s.a.createElement("div",null,"No selections available")},rowRenderer:function(e){var t=e.index,r=e.parent,n=e.key,a=e.style;return s.a.createElement(c.b,{key:n,cache:i.cache,parent:r,columnIndex:0,rowIndex:t},s.a.createElement("div",{style:a},o[t]))}})})))}}])&&l(t.prototype,n),a&&l(t,a),r}();t.b=function(e){return s.a.createElement(a.default,o({components:{VirtualizedMenuList:f}},e))}},"9KAa":function(e,t,r){"use strict";r.r(t);var n=r("q1tI"),u=r.n(n),a=r("i8i4"),i=r.n(a),s=r("2vnA"),o=r("XoI5");var c,d,g,_,h,y,b,v,E,O,w,k,j,N,P,S,x,C,A,z,D,F,U,R,T,I,H,L,B,q,M,V,G,l=function(e,t){return o.a.get("/tola_management/user/",{params:function(a){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,r,n;t=a,n=i[r=e],r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n})}return a}({page:e},t)}).then(function(e){var t=e.data,r=t.count,n=(t.results.length,t.page_count);return{users:t.results,total_pages:n,total_users:r,next_page:t.next,prev_page:t.previous}})},p=function(e){return o.a.get("/tola_management/user/".concat(e,"/")).then(function(e){return e.data})},m=function(e,t){return o.a.put("/tola_management/user/".concat(e,"/"),t).then(function(e){return e.data})},X=function(e){return o.a.get("/tola_management/user/".concat(e,"/program_access/")).then(function(e){return e.data})},K=function(e,t){return o.a.put("/tola_management/user/".concat(e,"/program_access/"),t).then(function(e){})},J=function(e){return o.a.get("/tola_management/user/".concat(e,"/history/")).then(function(e){return e.data})},Y=function(e){return o.a.post("/tola_management/user/",e).then(function(e){return e.data})},W=function(e){return o.a.post("/tola_management/user/".concat(e,"/resend_registration_email/"),{}).then(function(e){return e.data})},$=function(e,t){return o.a.post("/tola_management/user/bulk_update_status/",{user_ids:e,new_status:t}).then(function(e){return e.data})},Z=function(e,t){return o.a.post("/tola_management/user/bulk_add_programs/",{user_ids:e,added_programs:t}).then(function(e){return e.data})},Q=function(e,t){return o.a.post("/tola_management/user/bulk_remove_programs/",{user_ids:e,removed_programs:t}).then(function(e){return e.data})},ee=function(e){return o.a.get("/tola_management/user/".concat(e,"/aggregate_data/")).then(function(e){return e.data})},te=function(e,t){return o.a.put("/tola_management/user/".concat(e,"/is_active/"),t).then(function(e){return e.data})};function re(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ne(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ae(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function ie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(r,n,e,t,a){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(r,n,e)||e},i),a&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(a):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(r,n,i),i=null),i}function oe(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(e){se(t,e,r[e])})}return t}function se(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ce,le={profile:oe({},{id:null,first_name:"",last_name:"",email:"",phone_number:"",organization_id:null,mode_of_contact:"",title:"",user_programs:0,user:{is_active:!0}}),access:{country:{},programs:[]},history:[]},ue=(d=f((c=function(){function f(e){var t=this,r=e.countries,n=e.organizations,a=e.programs,i=e.users,o=e.access,s=e.is_superuser,c=e.programs_filter,l=e.country_filter,u=e.organizations_filter,p=e.program_role_choices,m=e.country_role_choices;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),ae(this,"users",d,this),ae(this,"users_listing",g,this),ae(this,"users_count",_,this),ae(this,"fetching_users_listing",h,this),ae(this,"current_page",y,this),ae(this,"total_pages",b,this),ae(this,"bulk_targets",v,this),ae(this,"bulk_targets_all",E,this),ae(this,"applying_bulk_updates",O,this),ae(this,"saving_user_profile",w,this),ae(this,"saving_user_programs",k,this),ae(this,"access",j,this),ae(this,"is_superuser",N,this),ae(this,"fetching_editing_target",P,this),ae(this,"editing_target",S,this),ae(this,"editing_target_data",x,this),ae(this,"editing_errors",C,this),ae(this,"new_user",A,this),ae(this,"countries",z,this),ae(this,"ordered_country_ids",D,this),ae(this,"organizations",F,this),ae(this,"programs",U,this),ae(this,"available_users",R,this),ae(this,"countries_selections",T,this),ae(this,"organization_selections",I,this),ae(this,"program_selections",H,this),ae(this,"user_selections",L,this),ae(this,"program_bulk_selections",B,this),ae(this,"unsaved_changes_actions",q,this),ae(this,"active_editor_pane",M,this),this.active_pane_is_dirty=!1,this.country_role_choices=[],this.program_role_choices=[],this.user_status_options=[{value:1,label:"Active"},{value:0,label:"Inactive"}],this.admin_role_options=[{value:1,label:"Yes"},{value:0,label:"No"}],ae(this,"filters",V,this),ae(this,"appliedFilters",G,this),this.countries=r,this.ordered_country_ids=Object.values(r).sort(function(e,t){return e.name.localeCompare(t.name)}).map(function(e){return e.id}),this.organizations=n,this.programs=a,this.available_users=i.filter(function(e){return e.name}),this.countries_selections=this.ordered_country_ids.map(function(e){return t.countries[e]}).map(function(e){return{value:e.id,label:e.name}}),this.organization_selections=Object.values(n).map(function(e){return{value:e.id,label:e.name}}),this.program_selections=this.createProgramSelections(this.programs),this.user_selections=this.available_users.map(function(e){return{value:e.id,label:e.name}}),this.program_bulk_selections=this.ordered_country_ids.map(function(e){return t.countries[e]}).map(function(t){return{label:t.name,options:t.programs.map(function(e){return{label:t.name+": "+a[e].name,value:t.id+"_"+e}})}}),this.access=o,this.is_superuser=s,this.filters.programs=c.map(function(e){return t.programs[e]}).map(function(e){return{label:e.name,value:e.id}}),this.filters.organizations=u.map(function(e){return t.organizations[e]}).map(function(e){return{label:e.name,value:e.id}}),this.filters.countries=l.map(function(e){return t.countries[e]}).map(function(e){return{label:e.name,value:e.id}}),this.country_role_choices=m.map(function(e){var t=ne(e,2),r=t[0];return{label:t[1],value:r}}),this.program_role_choices=p.map(function(e){var t=ne(e,2),r=t[0];return{label:t[1],value:r}}),this.appliedFilters=oe({},this.filters),this.fetchUsers()}var e,t,r;return e=f,(t=[{key:"marshalFilters",value:function(e){return Object.entries(e).reduce(function(e,t){return Array.isArray(t[1])?e[t[0]]=t[1].map(function(e){return e.value}):e[t[0]]=t[1].value,e},{})}},{key:"dirtyConfirm",value:function(){return!this.active_pane_is_dirty||this.active_pane_is_dirty&&confirm(gettext("You have unsaved changes. Are you sure you want to discard them?"))}},{key:"getSelectedBulkTargetIDs",value:function(){return re(this.bulk_targets.entries()).filter(function(e){var t=ne(e,2);t[0];return t[1]}).map(function(e){var t=ne(e,2),r=t[0];t[1];return r})}},{key:"onSaveErrorHandler",value:function(e){PNotify.error({text:e||gettext("Saving Failed"),delay:5e3})}},{key:"onSaveSuccessHandler",value:function(e){PNotify.success({text:e||gettext("Successfully Saved"),delay:5e3})}},{key:"createProgramSelections",value:function(e){return Object.values(e).map(function(e){return{value:e.id,label:e.name}})}},{key:"onProfilePaneChange",value:function(e){this.dirtyConfirm()&&(this.active_editor_pane=e,this.active_pane_is_dirty=!1)}},{key:"setActiveFormIsDirty",value:function(e){this.active_pane_is_dirty=e}},{key:"fetchUsers",value:function(){var t=this;this.dirtyConfirm()&&(this.fetching_users_listing=!0,l(this.current_page+1,this.marshalFilters(this.appliedFilters)).then(function(e){Object(s.m)(function(){t.active_editor_pane="profile",t.active_pane_is_dirty=!1,t.fetching_users_listing=!1,t.users=e.users.reduce(function(e,t){return e[t.id]=t,e},{}),t.users_listing=e.users.map(function(e){return e.id}),t.bulk_targets_all=!1,t.bulk_targets=new Map,t.users_count=e.total_users,t.total_pages=e.total_pages,t.next_page=e.next_page,t.previous_page=e.previous_page})}))}},{key:"applyFilters",value:function(){this.appliedFilters=oe({},this.filters),this.current_page=0,this.fetchUsers()}},{key:"changePage",value:function(e){e.selected!=this.current_page&&(this.current_page=e.selected,this.fetchUsers())}},{key:"toggleBulkTargetsAll",value:function(){var t=this;this.bulk_targets_all=!this.bulk_targets_all;var e=Object.values(this.users_listing);this.bulk_targets=new Map(e.map(function(e){return[e,t.bulk_targets_all]}))}},{key:"toggleBulkTarget",value:function(e){this.bulk_targets.set(e,!this.bulk_targets.get(e))}},{key:"changeCountryFilter",value:function(e){var t=this;if(0==(this.filters.countries=e).length)this.program_selections=this.createProgramSelections(this.programs);else{var r=e.map(function(e){return e.value}).map(function(e){return t.countries[e]}).flatMap(function(e){return e.programs}),n=new Set(r);this.program_selections=this.createProgramSelections(Array.from(n).map(function(e){return t.programs[e]}))}}},{key:"changeBaseCountryFilter",value:function(e){this.filters.base_countries=e}},{key:"changeOrganizationFilter",value:function(e){this.filters.organizations=e}},{key:"changeProgramFilter",value:function(e){this.filters.programs=e}},{key:"changeUserStatusFilter",value:function(e){this.filters.user_status=e}},{key:"changeAdminRoleFilter",value:function(e){this.filters.admin_role=e}},{key:"changeUserFilter",value:function(e){this.filters.users=e}},{key:"toggleEditingTarget",value:function(e){var i=this;this.dirtyConfirm()&&(this.editing_errors={},this.editing_target_data=oe({},le),this.active_pane_is_dirty=!1,"new"==this.editing_target&&this.users_listing.shift(),this.active_editor_pane="profile",this.editing_target==e?this.editing_target=null:(this.editing_target=e,this.fetching_editing_target=!0,Promise.all([p(e),X(e),J(e)]).then(function(e){var t=ne(e,3),r=t[0],n=t[1],a=t[2];Object(s.m)(function(){i.fetching_editing_target=!1,i.editing_target_data={profile:r,access:n,history:a}})})))}},{key:"updateActiveEditPage",value:function(e){this.active_edit_page=e,this.active_pane_is_dirty=!1}},{key:"createUser",value:function(){this.dirtyConfirm()&&(this.editing_errors={},this.active_pane_is_dirty=!1,this.active_editor_pane="profile","new"==this.editing_target&&this.users_listing.shift(),this.editing_target_data=oe({},le),this.users.new={id:"new",name:"",organization_name:"",user_programs:0,is_admin:!1,is_active:!1},this.users_listing.unshift("new"),this.editing_target="new")}},{key:"updateUserProfile",value:function(e,t){var i=this;this.saving_user_profile=!0,this.editing_errors={},this.active_pane_is_dirty=!1,m(e,t).then(function(a){return Promise.all([ee(a.id),J(a.id)]).then(function(e){var t=ne(e,2),r=t[0],n=t[1];i.onSaveSuccessHandler(),Object(s.m)(function(){i.saving_user_profile=!1,i.users[a.id]={id:a.id,name:a.name,organization_name:i.organizations[a.organization_id].name,user_programs:r.program_count,is_admin:a.user.is_staff,is_active:a.user.is_active},i.active_pane_is_dirty=!1,i.editing_target_data.profile=a,i.editing_target_data.history=n})})}).catch(function(e){i.onSaveErrorHandler(e.response.data.detail),Object(s.m)(function(){i.saving_user_profile=!1,i.editing_errors=e.response.data})})}},{key:"updateUserIsActive",value:function(e,t){var i=this;this.saving_user_profile=!0,this.editing_errors={},this.active_pane_is_dirty=!1,te(e,t).then(function(a){return Promise.all([ee(e),J(e)]).then(function(e){var t=ne(e,2),r=t[0],n=t[1];i.onSaveSuccessHandler(),Object(s.m)(function(){i.saving_user_profile=!1,i.users[a.id]={id:a.id,name:a.name,organization_name:i.organizations[a.organization_id].name,user_programs:r.program_count,is_admin:a.user.is_staff,is_active:a.user.is_active},i.active_pane_is_dirty=!1,i.editing_target_data.profile=a,i.editing_target_data.history=n})})}).catch(function(e){i.onSaveErrorHandler(e.response.data.detail),Object(s.m)(function(){i.saving_user_profile=!1,i.editing_errors=e.response.data})})}},{key:"resendRegistrationEmail",value:function(e){var t=this;this.saving_user_profile=!0,W(e).then(function(e){Object(s.m)(function(){t.saving_user_profile=!1,t.onSaveSuccessHandler(gettext("Verification email sent"))})}).catch(function(){t.onSaveSuccessHandler(gettext("Verification email send failed"))})}},{key:"saveNewUser",value:function(e){var r=this;this.saving_user_profile=!0,this.editing_errors={},this.active_pane_is_dirty=!1,Y(e).then(function(t){return ee(t.id).then(function(e){r.onSaveSuccessHandler(),Object(s.m)(function(){r.saving_user_profile=!1,r.users[t.id]={id:t.id,name:t.name,organization_name:r.organizations[t.organization_id].name,user_programs:e.program_count,is_admin:t.user.is_staff,is_active:t.user.is_active},r.active_pane_is_dirty=!1,r.user_selections.push({value:t.id,label:t.name}),r.users_listing[0]=t.id,r.editing_target=null,r.toggleEditingTarget(t.id),delete r.users.new})})}).catch(function(e){r.onSaveErrorHandler(e.response.data.detail),Object(s.m)(function(){r.saving_user_profile=!1,r.editing_errors=e.response.data})})}},{key:"saveNewUserAndAddAnother",value:function(e){var r=this;this.saving_user_profile=!0,this.editing_errors={},this.active_pane_is_dirty=!1,Y(e).then(function(t){return ee(t.id).then(function(e){r.onSaveSuccessHandler(),Object(s.m)(function(){r.saving_user_profile=!1,r.users[t.id]={id:t.id,name:t.name,organization_name:r.organizations.find(function(e){return e.id=t.organization_id}).name,user_programs:e.program_count,is_admin:t.user.is_staff,is_active:t.user.is_active},r.active_pane_is_dirty=!1,r.users_listing[0]=t.id,delete r.users.new,r.createUser()})})}).catch(function(e){r.onSaveErrorHandler(e.response.data.detail),Object(s.m)(function(){r.saving_user_profile=!1,r.editing_errors=e.response.data})})}},{key:"saveUserPrograms",value:function(i,e){var o=this;this.saving_user_programs=!0,this.active_pane_is_dirty=!1,K(i,e).then(function(e){return Promise.all([ee(i),J(i),X(i)]).then(function(e){var t=ne(e,3),r=t[0],n=t[1],a=t[2];Object(s.m)(function(){o.saving_user_programs=!1,o.users[i].user_programs=r.program_count,o.editing_target_data.history=n,o.editing_target_data.access=a,o.active_pane_is_dirty=!1}),o.onSaveSuccessHandler()})}).catch(function(e){o.onSaveErrorHandler(e.response.data.detail),Object(s.m)(function(){o.saving_user_programs=!1})})}},{key:"bulkUpdateUserStatus",value:function(e){var r=this;this.applying_bulk_updates=!0,$(this.getSelectedBulkTargetIDs(),e).then(function(e){Object(s.m)(function(){e.forEach(function(e){var t=Object.assign(r.users[e.id],e);r.users[t.id]=t}),r.applying_bulk_updates=!1}),r.onSaveSuccessHandler()}).catch(function(e){Object(s.m)(function(){r.applying_bulk_updates=!1}),r.onSaveErrorHandler()})}},{key:"bulkAddPrograms",value:function(e){var a=this;this.applying_bulk_updates=!0,Z(this.getSelectedBulkTargetIDs(),e.map(function(e){var t=ne(e.split("_"),2);return{country:t[0],program:t[1],role:"low"}})).then(function(e){a.getSelectedBulkTargetIDs().forEach(function(e){a.editing_target==e&&X(e).then(function(e){Object(s.m)(function(){a.editing_target_data.access=e})})}),Object(s.m)(function(){Object.entries(e).forEach(function(e){var t=ne(e,2),r=t[0],n=t[1];a.users[r].user_programs=n}),a.applying_bulk_updates=!1}),a.onSaveSuccessHandler()}).catch(function(e){Object(s.m)(function(){a.applying_bulk_updates=!1}),a.onSaveErrorHandler()})}},{key:"bulkRemovePrograms",value:function(e){var a=this;this.applying_bulk_updates=!0,Q(this.getSelectedBulkTargetIDs(),e.map(function(e){var t=ne(e.split("_"),2);return{country:t[0],program:t[1],role:"low"}})).then(function(e){a.getSelectedBulkTargetIDs().forEach(function(e){a.editing_target==e&&X(e).then(function(e){Object(s.m)(function(){a.editing_target_data.access=e})})}),Object(s.m)(function(){Object.entries(e).forEach(function(e){var t=ne(e,2),r=t[0],n=t[1];a.users[r].user_programs=n}),a.applying_bulk_updates=!1}),a.onSaveSuccessHandler()}).catch(function(e){Object(s.m)(function(){a.applying_bulk_updates=!1}),a.onSaveErrorHandler()})}},{key:"clearFilters",value:function(){this.filters={countries:[],base_countries:[],organizations:[],programs:[],user_status:"",admin_role:"",users:[]}}}])&&ie(e.prototype,t),r&&ie(e,r),f}()).prototype,"users",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),g=f(c.prototype,"users_listing",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_=f(c.prototype,"users_count",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=f(c.prototype,"fetching_users_listing",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),y=f(c.prototype,"current_page",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),b=f(c.prototype,"total_pages",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=f(c.prototype,"bulk_targets",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),E=f(c.prototype,"bulk_targets_all",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),O=f(c.prototype,"applying_bulk_updates",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),w=f(c.prototype,"saving_user_profile",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),k=f(c.prototype,"saving_user_programs",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),j=f(c.prototype,"access",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{countries:{},programs:{}}}}),N=f(c.prototype,"is_superuser",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),P=f(c.prototype,"fetching_editing_target",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),S=f(c.prototype,"editing_target",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=f(c.prototype,"editing_target_data",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return oe({},le)}}),C=f(c.prototype,"editing_errors",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),A=f(c.prototype,"new_user",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=f(c.prototype,"countries",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),D=f(c.prototype,"ordered_country_ids",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=f(c.prototype,"organizations",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),U=f(c.prototype,"programs",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),R=f(c.prototype,"available_users",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),T=f(c.prototype,"countries_selections",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),I=f(c.prototype,"organization_selections",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),H=f(c.prototype,"program_selections",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=f(c.prototype,"user_selections",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),B=f(c.prototype,"program_bulk_selections",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),q=f(c.prototype,"unsaved_changes_actions",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{save:function(){},discard:function(){}}}}),M=f(c.prototype,"active_editor_pane",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"profile"}}),V=f(c.prototype,"filters",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{countries:[],base_countries:[],organizations:[],programs:[],user_status:"",admin_role:"",users:[]}}}),G=f(c.prototype,"appliedFilters",[s.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),f(c.prototype,"onProfilePaneChange",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"onProfilePaneChange"),c.prototype),f(c.prototype,"fetchUsers",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"fetchUsers"),c.prototype),f(c.prototype,"applyFilters",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"applyFilters"),c.prototype),f(c.prototype,"changePage",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"changePage"),c.prototype),f(c.prototype,"toggleBulkTargetsAll",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"toggleBulkTargetsAll"),c.prototype),f(c.prototype,"toggleBulkTarget",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"toggleBulkTarget"),c.prototype),f(c.prototype,"changeCountryFilter",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"changeCountryFilter"),c.prototype),f(c.prototype,"changeBaseCountryFilter",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"changeBaseCountryFilter"),c.prototype),f(c.prototype,"changeOrganizationFilter",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"changeOrganizationFilter"),c.prototype),f(c.prototype,"changeProgramFilter",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"changeProgramFilter"),c.prototype),f(c.prototype,"changeUserStatusFilter",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"changeUserStatusFilter"),c.prototype),f(c.prototype,"changeAdminRoleFilter",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"changeAdminRoleFilter"),c.prototype),f(c.prototype,"changeUserFilter",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"changeUserFilter"),c.prototype),f(c.prototype,"toggleEditingTarget",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"toggleEditingTarget"),c.prototype),f(c.prototype,"updateActiveEditPage",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"updateActiveEditPage"),c.prototype),f(c.prototype,"createUser",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"createUser"),c.prototype),f(c.prototype,"updateUserProfile",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"updateUserProfile"),c.prototype),f(c.prototype,"updateUserIsActive",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"updateUserIsActive"),c.prototype),f(c.prototype,"resendRegistrationEmail",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"resendRegistrationEmail"),c.prototype),f(c.prototype,"saveNewUser",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"saveNewUser"),c.prototype),f(c.prototype,"saveNewUserAndAddAnother",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"saveNewUserAndAddAnother"),c.prototype),f(c.prototype,"saveUserPrograms",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"saveUserPrograms"),c.prototype),f(c.prototype,"bulkUpdateUserStatus",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"bulkUpdateUserStatus"),c.prototype),f(c.prototype,"bulkAddPrograms",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"bulkAddPrograms"),c.prototype),f(c.prototype,"bulkRemovePrograms",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"bulkRemovePrograms"),c.prototype),f(c.prototype,"clearFilters",[s.d],Object.getOwnPropertyDescriptor(c.prototype,"clearFilters"),c.prototype),c),pe=r("okNM"),me=r("y2Vs"),fe=r("Z2Y6"),de=r("TGVD");function ge(e){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function he(e,t){return!t||"object"!==ge(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function ye(e){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function be(e,t){return(be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ve,Ee=Object(pe.a)(ce=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),he(this,ye(t).apply(this,arguments))}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&be(e,t)}(t,u.a.Component),r=t,(n=[{key:"updateActivePage",value:function(e){this.props.new||this.props.notifyPaneChange(e)}},{key:"render",value:function(){var t=this,e=this.props,r=e.ProfileSection,n=e.ProgramSection,a=e.HistorySection,i=e.active_pane,o="profile"==i?"active":"",s="programs_and_roles"==i?"active":"",c="status_and_history"==i?"active":"",l=this.props.new?"disabled":"";return u.a.createElement("div",{className:"tab-set--vertical"},u.a.createElement("ul",{className:"nav nav-tabs"},u.a.createElement("li",{className:"nav-item"},u.a.createElement("a",{href:"#",className:"nav-link ".concat(o),onClick:function(e){e.preventDefault(),t.updateActivePage("profile")}},gettext("Profile"))),u.a.createElement("li",{className:"nav-item"},u.a.createElement("a",{href:"#",className:"nav-link text-nowrap ".concat(s," ").concat(l),onClick:function(e){e.preventDefault(),t.updateActivePage("programs_and_roles")}},gettext("Programs and Roles"))),u.a.createElement("li",{className:"nav-item"},u.a.createElement("a",{href:"#",className:"nav-link text-nowrap ".concat(c," ").concat(l),onClick:function(e){e.preventDefault(),t.updateActivePage("status_and_history")}},gettext("Status and History")))),u.a.createElement("div",{className:"tab-content"},"profile"==i&&u.a.createElement(r,null),"programs_and_roles"==i&&u.a.createElement(n,null),"status_and_history"==i&&u.a.createElement(a,null)))}}])&&_e(r.prototype,n),a&&_e(r,a),t}())||ce;function Oe(e){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function we(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(e){ke(t,e,r[e])})}return t}function ke(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function je(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ne(e,t){return!t||"object"!==Oe(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function Pe(e){return(Pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Se(e,t){return(Se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xe,Ce=Object(pe.a)(ve=function(e){function i(t){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e=Ne(this,Pe(i).call(this,t));var r=t.userData,n=t.new?t.organizations.filter(function(e){return 1!=e.value||t.is_superuser}):t.organizations,a=n.find(function(e){return e.value==r.organization_id});return e.state={original_user_data:we({},r),managed_user_data:we({},r),selected_organization:a,organization_listing:n},e}var t,r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Se(e,t)}(i,u.a.Component),t=i,(r=[{key:"save",value:function(){this.props.onUpdate(this.state.managed_user_data)}},{key:"saveNew",value:function(e){e.preventDefault(),this.props.onCreate(this.state.managed_user_data)}},{key:"saveNewAndAddAnother",value:function(e){e.preventDefault(),this.props.onCreateAndAddAnother(this.state.managed_user_data)}},{key:"updateFirstName",value:function(e){var t=this;this.setState({managed_user_data:we({},this.state.managed_user_data,{first_name:e})},function(){return t.hasUnsavedDataAction()})}},{key:"updateLastName",value:function(e){var t=this;this.setState({managed_user_data:we({},this.state.managed_user_data,{last_name:e})},function(){return t.hasUnsavedDataAction()})}},{key:"updateOrganization",value:function(e){var t=this;this.setState({managed_user_data:we({},this.state.managed_user_data,{organization_id:e.value}),selected_organization:e},function(){return t.hasUnsavedDataAction()})}},{key:"updateTitle",value:function(e){var t=this;this.setState({managed_user_data:we({},this.state.managed_user_data,{title:e})},function(){return t.hasUnsavedDataAction()})}},{key:"updateEmail",value:function(e){var t=this;this.setState({managed_user_data:we({},this.state.managed_user_data,{email:e})},function(){return t.hasUnsavedDataAction()})}},{key:"updatePhone",value:function(e){var t=this;this.setState({managed_user_data:we({},this.state.managed_user_data,{phone_number:e})},function(){return t.hasUnsavedDataAction()})}},{key:"updateModeOfContact",value:function(e){var t=this;this.setState({managed_user_data:we({},this.state.managed_user_data,{mode_of_contact:e})},function(){return t.hasUnsavedDataAction()})}},{key:"hasUnsavedDataAction",value:function(){this.props.onIsDirtyChange(JSON.stringify(this.state.managed_user_data)!=JSON.stringify(this.state.original_user_data))}},{key:"resetForm",value:function(){var t=this,e=this.state.organization_listing.find(function(e){return e.value==t.state.original_user_data.organization_id});this.setState({managed_user_data:this.state.original_user_data,selected_organization:e},function(){return t.hasUnsavedDataAction()})}},{key:"render",value:function(){var t=this,e=this.state.managed_user_data,r=this.props.errors,n=this.props.disabled,a=r.first_name?"is-invalid":"",i=r.last_name?"is-invalid":"",o=r.email?"is-invalid":"",s=r.organization_id?"is-invalid":"";return u.a.createElement("div",{className:"tab-pane--react"},u.a.createElement("h2",{className:"no-bold"},e.name?e.name+": ":"","Profile"),u.a.createElement("form",{className:"form"},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"user-first-name-input"},gettext("Preferred First Name"),u.a.createElement("span",{className:"required"},"*")),u.a.createElement("input",{disabled:n,className:"form-control "+a,type:"text",value:e.first_name,onChange:function(e){return t.updateFirstName(e.target.value)},id:"user-first-name-input",required:!0}),r.first_name&&u.a.createElement("div",{className:"invalid-feedback"},r.first_name)),u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"user-last-name-input"},gettext("Preferred Last Name"),u.a.createElement("span",{className:"required"},"*")),u.a.createElement("input",{disabled:n,className:"form-control "+i,type:"text",value:e.last_name,onChange:function(e){return t.updateLastName(e.target.value)},id:"user-last-name-input",required:!0}),r.last_name&&u.a.createElement("div",{className:"invalid-feedback"},r.last_name)),u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"user-organization-input"},gettext("Organization"),u.a.createElement("span",{className:"required"},"*")),u.a.createElement(me.default,{isDisabled:n,className:"form-control "+s,value:this.state.selected_organization,options:this.state.organization_listing,onChange:function(e){return t.updateOrganization(e)},placeholder:"None Selected",id:"user-organization-input"}),r.organization_id&&u.a.createElement("div",{className:"invalid-feedback"},r.organization_id)),u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"user-title-input"},gettext("Title")),u.a.createElement("input",{disabled:n,maxLength:"50",type:"text",value:e.title,onChange:function(e){return t.updateTitle(e.target.value)},className:"form-control",id:"user-title-input"})),u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"user-email-input"},gettext("Email"),u.a.createElement("span",{className:"required"},"*")),u.a.createElement("input",{disabled:n,className:"form-control "+o,type:"email",value:e.email,onChange:function(e){return t.updateEmail(e.target.value)},id:"user-email-input"}),r.email&&u.a.createElement("div",{className:"invalid-feedback"},r.email)),u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"user-phone-input"},gettext("Phone")),u.a.createElement("input",{disabled:n,type:"tel",value:e.phone_number,onChange:function(e){return t.updatePhone(e.target.value)},className:"form-control",id:"user-phone-input"})),u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"user-mode-of-contact-input"},gettext("Preferred Mode of Contact")),u.a.createElement("input",{disabled:n,type:"text",value:e.mode_of_contact,onChange:function(e){return t.updateModeOfContact(e.target.value)},className:"form-control",id:"user-mode-of-contact-input"})),this.props.new&&!n&&u.a.createElement("div",{className:"form-group btn-row"},u.a.createElement("button",{className:"btn btn-primary",type:"button",onClick:function(e){return t.saveNew(e)}},gettext("Save changes")),u.a.createElement("button",{className:"btn btn-secondary",onClick:function(e){return t.saveNewAndAddAnother(e)}},gettext("Save And Add Another")),u.a.createElement("button",{className:"btn btn-reset",type:"button",onClick:function(){return t.resetForm()}},gettext("Reset"))),!this.props.new&&!n&&u.a.createElement("div",{className:"form-group btn-row"},u.a.createElement("button",{className:"btn btn-primary",type:"button",onClick:function(e){return t.save()}},gettext("Save changes")),u.a.createElement("button",{className:"btn btn-reset",type:"button",onClick:function(){return t.resetForm()}},gettext("Reset")))))}}])&&je(t.prototype,r),n&&je(t,n),i}())||ve,Ae=r("c7k8"),ze=r("5Xg7");function De(e){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ue(e,t){return!t||"object"!==De(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function Re(e){return(Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Te(e,t){return(Te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ie(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function He(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(e){Le(t,e,r[e])})}return t}function Le(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Be(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var qe=function(e,i){return Object.entries(e).reduce(function(e,t){var r=Be(t,2),n=r[0],a=r[1];return He({},e,Le({},n,He({},a,{type:"country",options:[{label:"",value:"none"}].concat(Ie(i.country_role_choices)),admin_access:i.is_superuser,programs:new Set(a.programs)})))},{})},Me=function(e,n){return Object.entries(e).reduce(function(e,t){var r=Be(t,2);return He({},e,Le({},r[0],He({},r[1],{type:"program",options:n.program_role_choices})))},{})},Ve=function(e,r){return e.flatMap(function(t){return[t].concat(Ie(Array.from(t.programs).filter(function(e){return r[e]}).map(function(e){return He({},r[e],{id:"".concat(t.id,"_").concat(e),country_id:t.id})})))})},Ge=function(e,t,r){if(!r)return{programs:e,countries:t};var n=Object.entries(e).filter(function(e){var t=Be(e,2);t[0];return t[1].name.toLowerCase().includes(r.toLowerCase())}).map(function(e){var t=Be(e,2);t[0];return t[1]});return{countries:Object.entries(t).filter(function(e){var t=Be(e,2),r=(t[0],t[1]);return n.some(function(e){return r.programs.has(e.id)})}).map(function(e){var t=Be(e,2);t[0];return t[1]}).reduce(function(e,t){return He({},e,Le({},t.id,t))},{}),programs:n.reduce(function(e,t){return He({},e,Le({},t.id,t))},{})}},Xe=function(t,e){return 0<e.length?e.filter(function(e){return t[e.value]}).map(function(e){return t[e.value]}).reduce(function(e,t){return He({},e,Le({},t.id,t))},{}):t},Ke=function(e){return{countries:Object.entries(e.countries).reduce(function(e,t){var r=Be(t,2);return He({},e,Le({},r[0],He({},r[1],{has_access:!0})))},{}),programs:e.programs.reduce(function(e,t){return He({},e,Le({},"".concat(t.country,"_").concat(t.program),He({},t,{has_access:!0})))},{})}},Je=function(t,r,n){return Array.from(t.programs).filter(function(e){return!!r[e]}).every(function(e){return n.programs["".concat(t.id,"_").concat(e)]&&n.programs["".concat(t.id,"_").concat(e)].has_access})},Ye=Object(pe.a)(xe=function(e){function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),t=Ue(this,Re(i).call(this,e));var r=e.store,n=qe(r.countries,r),a=Me(r.programs,r);return t.state={program_filter:"",country_filter:[],country_selections:Object.entries(r.countries).map(function(e){var t=Be(e,2),r=(t[0],t[1]);return{value:r.id,label:r.name}}),countries:n,programs:a,filtered_countries:n,filtered_programs:a,ordered_country_ids:r.ordered_country_ids,flattened_programs:Ve(r.ordered_country_ids.filter(function(e){return e in n}).map(function(e){return n[e]}),a),original_user_program_access:Ke(r.editing_target_data.access),user_program_access:Ke(r.editing_target_data.access)},t}var t,r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Te(e,t)}(i,u.a.Component),t=i,(r=[{key:"componentWillReceiveProps",value:function(e){var t=this,r=e.store,n=qe(r.countries,r),a=Me(r.programs,r),i=Xe(n,this.state.country_filter),o=Ge(a,i,this.state.program_filter),s=o.countries,c=o.programs;this.setState({countries:n,programs:a,country_selections:Object.entries(r.countries).map(function(e){var t=Be(e,2),r=(t[0],t[1]);return{value:r.id,label:r.name}}),filtered_countries:s,filtered_programs:c,ordered_country_ids:r.ordered_country_ids,flattened_programs:Ve(r.ordered_country_ids.filter(function(e){return e in s}).map(function(e){return s[e]}),c),original_user_program_access:Ke(r.editing_target_data.access),user_program_access:Ke(r.editing_target_data.access)},function(){return t.hasUnsavedDataAction()})}},{key:"saveForm",value:function(){var r=this,e=this.state.user_program_access;this.props.onSave({countries:Object.entries(e.countries).filter(function(e){var t=Be(e,2);t[0],t[1];return r.props.store.is_superuser}).filter(function(e){var t=Be(e,2);t[0];return t[1].has_access}).reduce(function(e,t){var r=Be(t,2);return He({},e,Le({},r[0],r[1]))},{}),programs:Object.entries(e.programs).filter(function(e){var t=Be(e,2);t[0];return t[1].has_access}).map(function(e){var t=Be(e,2);t[0];return t[1]})}),this.hasUnsavedDataAction()}},{key:"hasUnsavedDataAction",value:function(){var e={countries:Object.entries(this.state.user_program_access.countries).filter(function(e){var t=Be(e,2);t[0];return t[1].has_access}).reduce(function(e,t){var r=Be(t,2);return He({},e,Le({},r[0],r[1]))},{}),programs:Object.entries(this.state.user_program_access.programs).filter(function(e){var t=Be(e,2);t[0];return t[1].has_access}).reduce(function(e,t){var r=Be(t,2);return He({},e,Le({},r[0],r[1]))},{})};this.props.onIsDirtyChange(JSON.stringify(e)!=JSON.stringify(this.state.original_user_program_access))}},{key:"resetForm",value:function(){var e=this;this.setState({user_program_access:{countries:He({},this.state.original_user_program_access.countries),programs:He({},this.state.original_user_program_access.programs)}},function(){return e.hasUnsavedDataAction()})}},{key:"toggleProgramAccess",value:function(t){var e=this,r=this.state.user_program_access.programs,n=function(){if(r[t])return He({},r[t],{has_access:!r[t].has_access});var e=Be(t.split("_"),2);return{country:e[0],program:e[1],role:"low",has_access:!0}}();this.setState({user_program_access:He({},this.state.user_program_access,{programs:He({},r,Le({},t,n))})},function(){return e.hasUnsavedDataAction()})}},{key:"toggleAllProgramsForCountry",value:function(e){var a=this,i=this.state.countries[e],t=Je(i,a.state.filtered_programs,a.state.user_program_access)?Array.from(i.programs).filter(function(e){return!!a.state.filtered_programs[e]}).reduce(function(e,t){var r="".concat(i.id,"_").concat(t),n=a.state.user_program_access.programs[r];return n?He({},e,Le({},r,He({},n,{has_access:!1}))):e},{}):Array.from(i.programs).filter(function(e){return!!a.state.filtered_programs[e]}).reduce(function(e,t){var r="".concat(i.id,"_").concat(t),n=a.state.user_program_access.programs[r];return He({},e,Le({},r,n?He({},n,{has_access:!0}):{program:t,country:i.id,role:"low",has_access:!0}))},{});this.setState({user_program_access:He({},this.state.user_program_access,{programs:He({},this.state.user_program_access.programs,t)})},function(){return a.hasUnsavedDataAction()})}},{key:"changeCountryRole",value:function(e,t){var r=this,n=He({},this.state.user_program_access.countries[e]),a=He({},n,"none"!=t?{role:t,has_access:!0}:{role:t,has_access:!1});this.setState({user_program_access:He({},this.state.user_program_access,{countries:He({},this.state.user_program_access.countries,Le({},e,a))})},function(){return r.hasUnsavedDataAction()})}},{key:"changeProgramRole",value:function(e,t){var r=this,n=Be(e.split("_"),2),a=n[0],i=n[1],o=this.state.user_program_access,s=o[a]&&o[a].has_access&&"low"==t?{program:i,country:a,role:t,has_access:!1}:{program:i,country:a,role:t,has_access:!0};this.setState({user_program_access:He({},this.state.user_program_access,{programs:He({},this.state.user_program_access.programs,Le({},e,s))})},function(){return r.hasUnsavedDataAction()})}},{key:"clearFilter",value:function(){var e=Xe(this.state.countries,this.state.country_filter),t=Ge(this.state.programs,e,""),r=t.countries,n=t.programs;this.setState({program_filter:"",filtered_programs:n,filtered_countries:r,flattened_programs:Ve(this.state.ordered_country_ids.filter(function(e){return e in r}).map(function(e){return r[e]}),n)})}},{key:"updateProgramFilter",value:function(e){var t=Xe(this.state.countries,this.state.country_filter),r=Ge(this.state.programs,t,e),n=r.countries,a=r.programs;this.setState({program_filter:e,filtered_programs:a,filtered_countries:n,flattened_programs:Ve(this.state.ordered_country_ids.filter(function(e){return e in n}).map(function(e){return n[e]}),a)})}},{key:"changeCountryFilter",value:function(e){var t=Xe(this.state.countries,e),r=Ge(this.state.programs,t,this.state.program_filter),n=r.countries;r.programs;this.setState({country_filter:e,filtered_countries:n,flattened_programs:Ve(this.state.ordered_country_ids.filter(function(e){return e in n}).map(function(e){return n[e]}),this.state.filtered_programs)})}},{key:"render",value:function(){var i=this,e=this.props,t=e.user;e.onSave;return u.a.createElement("div",{className:"tab-pane--react edit-user-programs"},u.a.createElement("h2",{className:"no-bold"},t.name?t.name+": ":"",gettext("Programs and Roles")),u.a.createElement("div",{className:"edit-user-programs__filter-form"},u.a.createElement("div",{className:"edit-user-programs__country-filter form-group"},u.a.createElement(ze.b,{placeholder:gettext("Filter countries"),isMulti:!0,value:this.state.country_filter,options:this.state.country_selections,onChange:function(e){return i.changeCountryFilter(e)}})),u.a.createElement("div",{className:"form-group edit-user-programs__program-filter"},u.a.createElement("div",{className:"input-group"},u.a.createElement("input",{placeholder:gettext("Filter programs"),type:"text",value:this.state.program_filter,className:"form-control",onChange:function(e){return i.updateProgramFilter(e.target.value)}}),u.a.createElement("div",{className:"input-group-append"},u.a.createElement("a",{onClick:function(e){e.preventDefault(),i.clearFilter()}},u.a.createElement("span",{className:"input-group-text"},u.a.createElement("i",{className:"fa fa-times-circle"}))))))),u.a.createElement("div",{className:"virtualized-table__wrapper"},u.a.createElement(Ae.a,null,function(e){var t=e.height,r=e.width;return u.a.createElement(Ae.f,{height:t,headerHeight:50,width:r,rowGetter:function(e){var t=e.index;return i.state.flattened_programs[t]},rowHeight:50,rowCount:i.state.flattened_programs.length},u.a.createElement(Ae.d,{dataKey:"not_applicable_but_required",width:100,cellDataGetter:function(e){var t,r,n,a=e.rowData;return{checked:(r=a,n=i.state.user_program_access,"country"==r.type?n.countries[r.id]&&n.countries[r.id].has_access||!1:!(!i.state.user_program_access.countries[r.country_id]||!i.state.user_program_access.countries[r.country_id].has_access)||n.programs[r.id]&&n.programs[r.id].has_access||!1),disabled:(t=a,"country"==t.type?!(0<i.state.countries[t.id].programs.size)||!(i.props.store.access.countries[t.id]&&"basic_admin"==i.props.store.access.countries[t.id].role)||i.state.user_program_access.countries[t.id]&&i.state.user_program_access.countries[t.id].has_access:!(!i.state.user_program_access.countries[t.country_id]||!i.state.user_program_access.countries[t.country_id].has_access)||!i.props.store.access.countries[t.country_id]||"basic_admin"!=i.props.store.access.countries[t.country_id].role),id:a.id,type:a.type,action:"country"==a.type?i.toggleAllProgramsForCountry.bind(i):i.toggleProgramAccess.bind(i)}},cellRenderer:function(e){var t=e.cellData;if("country"!=t.type)return u.a.createElement("div",{className:"check-column"},u.a.createElement("input",{type:"checkbox",checked:t.checked,disabled:t.disabled,onChange:function(){return t.action(t.id)}}));var r=Je(i.state.countries[t.id],i.state.filtered_programs,i.state.user_program_access)?gettext("Deselect All"):gettext("Select All");return t.disabled?null:u.a.createElement("div",{className:"check-column"},u.a.createElement("a",{className:"edit-user-programs__select-all",onClick:function(e){return t.action(t.id)}},r))}}),u.a.createElement(Ae.d,{dataKey:"not_applicable_but_required",label:gettext("Countries and Programs"),width:200,flexGrow:2,cellDataGetter:function(e){var t=e.rowData;return{bold:"country"==t.type,name:t.name}},cellRenderer:function(e){var t=e.cellData;return t.bold?u.a.createElement("strong",null,t.name):u.a.createElement("span",null,t.name)}}),u.a.createElement(Ae.d,{width:100,flexGrow:1,dataKey:"not_applicable_but_required",label:gettext("Roles and Permissions"),cellDataGetter:function(e){var t,r=e.rowData;return{id:r.id,disabled:(t=r,"country"==t.type?!i.props.store.is_superuser:!(i.props.store.access.countries[t.country_id]&&"basic_admin"==i.props.store.access.countries[t.country_id].role&&(i.state.user_program_access.programs[t.id]&&i.state.user_program_access.programs[t.id].has_access||i.state.user_program_access.countries[t.country_id]&&i.state.user_program_access.countries[t.country_id].has_access))),type:r.type,options:r.options,action:"country"==r.type?i.changeCountryRole.bind(i):i.changeProgramRole.bind(i)}},cellRenderer:function(e){var t=e.cellData;return u.a.createElement("select",{disabled:t.disabled,value:function(e){if("country"==e.type){var t=i.state.user_program_access.countries;return t[e.id]?t[e.id].role:"none"}var r=i.state.user_program_access.programs;return r[e.id]?r[e.id].role:i.props.store.program_role_choices[0].value}(t),onChange:function(e){return t.action(t.id,e.target.value)}},t.options.map(function(e){return u.a.createElement("option",{key:e.value,value:e.value},e.label)}))}}))})),u.a.createElement("div",{className:"form-group btn-row"},u.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return i.saveForm()}},"Save Changes"),u.a.createElement("button",{type:"button",className:"btn btn-reset",onClick:function(){return i.resetForm()}},"Reset")))}}])&&Fe(t.prototype,r),n&&Fe(t,n),i}())||xe,We=r("KnAV");function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qe(e,t){return!t||"object"!==$e(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function et(e){return(et=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tt(e,t){return(tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rt=[{value:!0,label:gettext("Active")},{value:!1,label:gettext("Inactive")}],nt=function(e){function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=Qe(this,et(r).call(this,e))).state={original_user_data:{user:{is_active:e.userData.user.is_active}},user_data:{user:{is_active:e.userData.user.is_active}}},t}var t,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tt(e,t)}(r,u.a.Component),t=r,(n=[{key:"save",value:function(){this.props.onSave(this.state.user_data)}},{key:"onChange",value:function(e){var t=this;this.setState({user_data:{user:{is_active:e.value}}},function(){return t.hasUnsavedDataAction()})}},{key:"onResendRegistrationEmail",value:function(){this.props.onResendRegistrationEmail()}},{key:"hasUnsavedDataAction",value:function(){this.props.onIsDirtyChange(this.state.user_data.user.is_active==this.state.user_data.user.is_active)}},{key:"onReset",value:function(){var e=this;this.setState({user_data:this.state.original_user_data},function(){return e.hasUnsavedDataAction()})}},{key:"render",value:function(){var t=this,e=rt.find(function(e){return e.value==t.state.user_data.user.is_active}),r=this.props.history;return u.a.createElement("div",{className:"edit-user-history"},u.a.createElement("h2",{className:"no-bold"},this.state.user_data.name?this.state.user_data.name+": ":"",gettext("Status and History")),u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col"},u.a.createElement(me.default,{isDisabled:this.props.disabled,options:rt,value:e,onChange:function(e){return t.onChange(e)}}))),u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col"},u.a.createElement("button",{className:"btn btn-secondary",onClick:function(){return t.onResendRegistrationEmail()}},gettext("Resend Registration Email")))),u.a.createElement("div",{className:"row"},!this.props.disabled&&u.a.createElement("div",{className:"col"},u.a.createElement("div",{className:"form-group btn-row"},u.a.createElement("button",{className:"btn btn-primary",type:"button",onClick:function(){return t.save()}},gettext("Save Changes")),u.a.createElement("button",{className:"btn btn-reset",type:"button",onClick:function(){return t.onReset()}},gettext("Reset"))))),u.a.createElement(We.a,{data:r}))}}])&&Ze(t.prototype,n),a&&Ze(t,a),r}(),at=r("RCjz"),it=r("DDFe"),ot=r("tnXs"),st=r("IP2g");function ct(){return(ct=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function lt(e){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function mt(e,t,r){return t&&pt(e.prototype,t),r&&pt(e,r),e}function ft(e,t){return!t||"object"!==lt(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function dt(e){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_t(e,t)}function _t(e,t){return(_t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ht=gettext("None Selected"),yt=Object(pe.a)(function(e){var t=e.store,r=e.selections;return u.a.createElement("div",{className:"form-group react-multiselect-checkbox"},u.a.createElement("label",{htmlFor:"users_filter"},gettext("Users")),u.a.createElement(fe.a,{value:t.filters.users,options:r,onChange:function(e){return t.changeUserFilter(e)},placeholder:ht,id:"users_filter"}))}),bt=Object(pe.a)(function(e){var t=e.store,r=e.selections;return u.a.createElement("div",{className:"form-group react-multiselect-checkbox"},u.a.createElement("label",{htmlFor:"countries_permitted_filter"},gettext("Countries Permitted")),u.a.createElement(fe.a,{value:t.filters.countries,options:r,onChange:function(e){return t.changeCountryFilter(e)},placeholder:ht,id:"countries_permitted_filter"}))}),vt=Object(pe.a)(function(e){var t=e.store,r=e.selections;return u.a.createElement("div",{className:"form-group react-multiselect-checkbox"},u.a.createElement("label",{htmlFor:"base_country_filter"},gettext("Base Country")),u.a.createElement(fe.a,{value:t.filters.base_countries,options:r,onChange:function(e){return t.changeBaseCountryFilter(e)},placeholder:ht,id:"base_country_filter"}))}),Et=Object(pe.a)(function(e){var t=e.store,r=e.selections;return u.a.createElement("div",{className:"form-group react-multiselect-checkbox"},u.a.createElement("label",{htmlFor:"programs_filter"},gettext("Programs")),u.a.createElement(fe.a,{value:t.filters.programs,options:r,onChange:function(e){return t.changeProgramFilter(e)},placeholder:ht,id:"programs_filter"}))}),Ot=function(e){function r(e){var t;return ut(this,r),(t=ft(this,dt(r).call(this,e))).active_child=u.a.createRef(),t.state={current_action:null,current_vals:[]},t}return gt(r,u.a.Component),mt(r,[{key:"onActionChanged",value:function(e){this.setState({current_action:e.value,current_vals:[]})}},{key:"onChange",value:function(e){this.setState({current_vals:e})}},{key:"onApply",value:function(){var e=this.props.secondaryOptions[this.state.current_action];e&&e.onApply(this.state.current_vals)}},{key:"render",value:function(){var t=this,e=this.props.secondaryOptions[this.state.current_action],r=e&&e.component,n=!this.state.current_action||Array.isArray(this.state.current_vals)&&!this.state.current_vals.length||!this.state.current_vals;return u.a.createElement("div",{className:"controls__bulk-actions"},u.a.createElement("div",{className:"bulk__select"},u.a.createElement(me.default,{placeholder:gettext("Bulk Actions"),value:this.props.primaryOptions.find(function(e){return e.value==t.state.current_action}),options:this.props.primaryOptions,onChange:function(e){return t.onActionChanged(e)}})),e&&u.a.createElement("div",{className:"bulk__select"},u.a.createElement(r,{value:this.state.current_vals,onChange:function(e){return t.onChange(e)}})),!e&&u.a.createElement("div",{className:"bulk__select"},u.a.createElement(me.default,{placeholder:"---"})),u.a.createElement("button",{className:"btn btn-secondary",disabled:n,onClick:function(){return t.onApply()}},"Apply"))}}]),r}(),wt=Object(pe.a)(function(e){var a=e.store,t=(a.program_selections,{primary_options:[{label:gettext("Set account status"),value:"set_account_status"},{label:gettext("Add to program"),value:"add_to_program"},{label:gettext("Remove from program"),value:"remove_from_program"}],secondary_options:{set_account_status:{component:function(e){return u.a.createElement(me.default,ct({options:a.user_status_options},e))},onApply:function(e){return a.bulkUpdateUserStatus(e.value)}},add_to_program:{component:function(e){return u.a.createElement(fe.a,ct({options:a.program_bulk_selections},e))},onApply:function(e){return a.bulkAddPrograms(e.map(function(e){return e.value}))}},remove_from_program:{component:function(e){return u.a.createElement(fe.a,ct({options:a.program_bulk_selections},e))},onApply:function(e){return a.bulkRemovePrograms(e.map(function(e){return e.value}))}}}});return u.a.createElement("div",{id:"user-management-index-view",className:"row"},u.a.createElement(ot.a,null,u.a.createElement("div",{className:"filter-section"},u.a.createElement(bt,{store:a,selections:a.countries_selections}),u.a.createElement(vt,{store:a,selections:a.countries_selections}),u.a.createElement(Et,{store:a,selections:a.program_selections}),u.a.createElement("div",{className:"form-group react-multiselect-checkbox"},u.a.createElement("label",{htmlFor:"organization_filter"},gettext("Organization")),u.a.createElement(fe.a,{value:a.filters.organizations,options:a.organization_selections,onChange:function(e){return a.changeOrganizationFilter(e)},placeholder:ht,id:"organization_filter"})),u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"status_filter"},gettext("Status")),u.a.createElement(me.default,{value:a.filters.user_status,options:a.user_status_options,onChange:function(e){return a.changeUserStatusFilter(e)},placeholder:ht,id:"status_filter"})),u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"admin_role_filter"},gettext("Admin Role")),u.a.createElement(me.default,{value:a.filters.admin_role,options:a.admin_role_options,onChange:function(e){return a.changeAdminRoleFilter(e)},placeholder:ht,id:"admin_role_filter"})),u.a.createElement(yt,{store:a,selections:a.user_selections}),u.a.createElement("div",{className:"filter-buttons"},u.a.createElement("button",{className:"btn btn-primary",onClick:function(){return a.applyFilters()}},gettext("Apply")),u.a.createElement("button",{className:"btn btn-inverse",onClick:function(){return a.clearFilters()}},gettext("Reset"))))),u.a.createElement("div",{className:"col admin-list"},u.a.createElement("header",{className:"page-title"},u.a.createElement("h1",null,gettext("Admin:")," ",u.a.createElement("small",null,gettext("Users")))),u.a.createElement("div",{className:"admin-list__controls"},u.a.createElement(Ot,{primaryOptions:t.primary_options,secondaryOptions:t.secondary_options}),u.a.createElement("div",{className:"controls__buttons"},u.a.createElement("a",{href:"#",tabIndex:"0",className:"btn btn-link btn-add",onClick:function(){return a.createUser()}},u.a.createElement("i",{className:"fas fa-plus-circle"}),gettext("Add User")))),u.a.createElement(it.a,{isLoading:a.fetching_users_listing||a.applying_bulk_updates},u.a.createElement("div",{className:"admin-list__table"},u.a.createElement(de.a,{data:a.users_listing.map(function(e){return a.users[e]}),keyField:"id",HeaderRow:function(e){var t=e.Col,r=e.Row;return u.a.createElement(r,null,u.a.createElement(t,{size:"0.5"},u.a.createElement("input",{type:"checkbox",checked:a.bulk_targets_all,onChange:function(){return a.toggleBulkTargetsAll()}})),u.a.createElement(t,{size:"2",className:"td--stretch"},gettext("User")),u.a.createElement(t,null,gettext("Organization")),u.a.createElement(t,null,gettext("Programs")),u.a.createElement(t,{size:"0.5"},gettext("Admin Role")),u.a.createElement(t,{size:"0.25"},gettext("Status")))},Row:function(e){var t=e.Col,r=e.Row,n=e.data;return u.a.createElement(r,{expanded:n.id==a.editing_target,Expando:Object(pe.a)(function(e){var t=e.Wrapper;return u.a.createElement(t,null,u.a.createElement(Ee,{notifyPaneChange:function(e){return a.onProfilePaneChange(e)},new:"new"==n.id,active_pane:a.active_editor_pane,ProfileSection:Object(pe.a)(function(){return u.a.createElement(it.a,{isLoading:a.fetching_editing_target||a.saving_user_profile||a.saving_user_programs},u.a.createElement(Ce,{disabled:1==n.organization_id&&!a.is_superuser&&"new"!=n.id,is_superuser:a.is_superuser,new:"new"==n.id,userData:a.editing_target_data.profile,errors:a.editing_errors,key:a.editing_target_data.profile.id,onUpdate:function(e){return a.updateUserProfile(n.id,e)},onCreate:function(e){return a.saveNewUser(e)},onCreateAndAddAnother:function(e){return a.saveNewUserAndAddAnother(e)},organizations:a.organization_selections,onIsDirtyChange:function(e){return a.setActiveFormIsDirty(e)}}))}),ProgramSection:Object(pe.a)(function(){return u.a.createElement(it.a,{isLoading:a.fetching_editing_target||a.saving_user_profile||a.saving_user_programs},u.a.createElement(Ye,{store:a,user:n,adminUserProgramRoles:a.access.program,adminUserCountryRoles:a.access.countries,onSave:function(e){return a.saveUserPrograms(n.id,e)},onIsDirtyChange:function(e){return a.setActiveFormIsDirty(e)}}))}),HistorySection:Object(pe.a)(function(){return u.a.createElement(it.a,{isLoading:a.fetching_editing_target||a.saving_user_profile||a.saving_user_programs},u.a.createElement(nt,{disabled:1==n.organization_id&&!a.is_superuser,userData:a.editing_target_data.profile,history:a.editing_target_data.history,onResendRegistrationEmail:function(){return a.resendRegistrationEmail(n.id)},onSave:function(e){return a.updateUserIsActive(n.id,e)},onIsDirtyChange:function(e){return a.setActiveFormIsDirty(e)}}))})}))})},u.a.createElement(t,{size:"0.5"},u.a.createElement("input",{type:"checkbox",checked:a.bulk_targets.get(n.id)||!1,onChange:function(){return a.toggleBulkTarget(n.id)}})),u.a.createElement(t,{size:"2",className:"td--stretch"},u.a.createElement("div",{className:"expando-toggle icon__clickable",onClick:function(){return a.toggleEditingTarget(n.id)}},u.a.createElement("div",{className:"expando-toggle__icon"},u.a.createElement(st.a,{icon:a.editing_target==n.id?"caret-down":"caret-right"})),u.a.createElement("div",{className:"expando-toggle__label"},u.a.createElement("i",{className:"fas fa-user"})," ",n.name||"---"," ",n.is_super&&u.a.createElement("span",{className:"badge badge-danger"},gettext("Super Admin"))))),u.a.createElement(t,null,u.a.createElement("i",{className:"fas fa-building"})," ",n.organization_name||"---"),u.a.createElement(t,{className:"text-nowrap"},u.a.createElement("a",{href:"/tola_management/program/?users[]=".concat(n.id)},u.a.createElement("i",{className:"fas fa-cubes"})," ",n.user_programs," ",gettext("programs"))),u.a.createElement(t,{size:"0.5"},n.is_admin?gettext("Yes"):gettext("No")),u.a.createElement(t,{size:"0.25"},n.is_active?gettext("Active"):gettext("Inactive")))}}))),u.a.createElement("div",{className:"admin-list__metadata"},u.a.createElement("div",{className:"metadata__count text-muted text-small"},a.users_count?"".concat(a.users_count," ").concat(gettext("users")):"--"),u.a.createElement("div",{className:"metadata__controls"},a.total_pages&&u.a.createElement(at.a,{pageCount:a.total_pages,initialPage:a.current_page,onPageChange:function(e){return a.changePage(e)}})))))}),kt=new ue(jsContext);i.a.render(u.a.createElement(wt,{store:kt}),document.querySelector("#app_root"))},DDFe:function(e,t,r){"use strict";var n=r("q1tI"),o=r.n(n);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function c(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],0<=t.indexOf(r)||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}t.a=function(e){var t=e.children,r=e.isLoading,n=e.className,a=c(e,["children","isLoading","className"]),i=r?"loading":"";return o.a.createElement("div",s({className:"loading-spinner__container "+i+" "+(n||"")},a),o.a.createElement("div",{className:"loading-spinner__overlay"},o.a.createElement("div",{className:"loading-spinner__spinner"})),t)}},KnAV:function(e,t,r){"use strict";var n=r("q1tI"),a=r.n(n),i=r("okNM");function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=function(e){var t=e.name,r=e.data;return a.a.createElement("div",{className:"change__field"},a.a.createElement("strong",null,t),": ",null!=r&&null!=r?r.toString():"N/A")},c=function(e){var t=e.data;return a.a.createElement("tr",{className:"changelog__entry__header is-expanded"},a.a.createElement("td",{className:"text-nowrap text-action"},a.a.createElement("i",{className:"fas fa-caret-down"})," ",a.a.createElement("strong",null,t.date)),a.a.createElement("td",{className:"text-nowrap"},t.admin_user),a.a.createElement("td",null,t.pretty_change_type),a.a.createElement("td",null),a.a.createElement("td",null))},l=function(e){var t=e.data;return"user_programs_updated"==t.change_type?a.a.createElement(a.a.Fragment,null,0<Object.entries(t.diff_list.countries).length&&Object.entries(t.diff_list.countries).map(function(e){var t=o(e,2),r=t[0],n=t[1];return a.a.createElement("tr",{key:r,className:"changelog__entry__row"},a.a.createElement("td",null),a.a.createElement("td",null),a.a.createElement("td",null),a.a.createElement("td",null,a.a.createElement("div",{className:"changelog__change--prev"},a.a.createElement(s,{name:"country",data:n.prev.country}),a.a.createElement(s,{name:"role",data:n.prev.role}))),a.a.createElement("td",null,a.a.createElement("div",{className:"changelog__change--new"},a.a.createElement(s,{name:"country",data:n.new.country}),a.a.createElement(s,{name:"role",data:n.new.role}))))}),0<Object.entries(t.diff_list.programs).length&&Object.entries(t.diff_list.programs).map(function(e){var t=o(e,2),r=t[0],n=t[1];return a.a.createElement("tr",{key:r,className:"changelog__entry__row"},a.a.createElement("td",null),a.a.createElement("td",null),a.a.createElement("td",null),a.a.createElement("td",null,a.a.createElement("div",{className:"changelog__change--prev"},a.a.createElement(s,{name:"program",data:n.prev.program}),a.a.createElement(s,{name:"country",data:n.prev.country}),a.a.createElement(s,{name:"role",data:n.prev.role}))),a.a.createElement("td",null,a.a.createElement("div",{className:"changelog__change--new"},a.a.createElement(s,{name:"program",data:n.new.program}),a.a.createElement(s,{name:"country",data:n.new.country}),a.a.createElement(s,{name:"role",data:n.new.role}))))})):a.a.createElement("tr",{className:"changelog__entry__row"},a.a.createElement("td",{className:"text-nowrap"}),a.a.createElement("td",null),a.a.createElement("td",null),a.a.createElement("td",null,a.a.createElement("div",{className:"changelog__change--prev"},t.diff_list.map(function(e,t){return a.a.createElement(s,{key:t,name:e.pretty_name,data:e.prev})}))),a.a.createElement("td",null,a.a.createElement("div",{className:"changelog__change--new"},t.diff_list.map(function(e,t){return a.a.createElement(s,{key:t,name:e.pretty_name,data:e.new})}))))},u=function(e){var t=e.data;return a.a.createElement("tbody",{className:"changelog__entry",key:t.id},a.a.createElement(c,{data:t}),a.a.createElement(l,{data:t}))},p=Object(i.a)(function(e){var t=e.data;return a.a.createElement("table",{className:"table table-sm bg-white table-bordered text-small changelog"},a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",{className:"text-nowrap"},gettext("Date")),a.a.createElement("th",{className:"text-nowrap"},gettext("Admin")),a.a.createElement("th",{className:"text-nowrap"},gettext("Change Type")),a.a.createElement("th",{className:"text-nowrap td--half-stretch"},gettext("Previous Entry")),a.a.createElement("th",{className:"text-nowrap td--half-stretch"},gettext("New Entry")))),t.map(function(e,t){return a.a.createElement(u,{key:t,data:e})}))});t.a=p},RCjz:function(e,t,r){"use strict";var n=r("q1tI"),a=r.n(n),i=r("werx"),o=r.n(i);r("okNM");function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}t.a=function(e){return a.a.createElement(o.a,s({previousLabel:"‹",previousClassName:"page-item previous",previousLinkClassName:"page-link",nextLabel:"›",nextClassName:"page-item next",nextLinkClassName:"page-link",breakLabel:"...",disabledClassName:"disabled",breakClassName:"page-item disabled",breakLinkClassName:"page-link",pageClassName:"page-item",pageLinkClassName:"page-link",marginPagesDisplayed:2,pageRangeDisplayed:5,containerClassName:"pagination",activeClassName:"active"},e))}},TGVD:function(e,t,r){"use strict";var o=r("okNM"),n=r("q1tI"),s=r.n(n),a=r("TSYQ"),c=r.n(a);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function u(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],0<=t.indexOf(r)||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var i=function(e){var t=e.className,r=(e.size,u(e,["className","size"]));return s.a.createElement("td",l({className:["mgmt-table__col",t].join(" ")},r),r.children)},p=function(e){var t=e.className,r=(e.size,u(e,["className","size"]));return s.a.createElement("th",l({className:["mgmt-table__col",t].join(" ")},r),r.children)},m=function(e){var t=e.className,r=u(e,["className"]);return s.a.createElement("tr",l({className:["mgmt-table__row",t].join(" ")},r),r.children)},f=function(e){var t=e.className,r=u(e,["className"]);return s.a.createElement("tr",l({className:["mgmt-table__row table-header",t].join(" ")},r),r.children)},d=Object(o.a)(function(e){var t=e.className,r=e.expanded,n=e.Expando,a=u(e,["className","expanded","Expando"]);if(n){var i=Object(o.a)(n);return s.a.createElement("tbody",l({className:c()(["mgmt-table__body",t].join(" "),{"is-expanded":r})},a),s.a.createElement(m,null,a.children),r&&s.a.createElement(i,{Wrapper:g}))}return s.a.createElement("tbody",l({className:["mgmt-table__body",t].join(" ")},a),s.a.createElement(m,null,a.children))}),g=function(e){var t=e.className,r=u(e,["className"]);return s.a.createElement("tr",l({className:["mgmt-table__row--expanded",t].join(" ")},r),s.a.createElement("td",{colSpan:"6"},r.children))},_=Object(o.a)(function(e){var t=e.data,r=e.Row,n=e.keyField,a=(u(e,["data","Row","keyField"]),Object(o.a)(r));return t.map(function(e){return s.a.createElement(a,{key:e[n],data:e,Col:i,Row:d})})}),h=Object(o.a)(function(e){var t=e.HeaderRow,r=e.className,n=u(e,["HeaderRow","className"]),a=Object(o.a)(t);return s.a.createElement("table",{className:["table bg-white",r].join(" ")},s.a.createElement("thead",null,s.a.createElement(a,{Col:p,Row:f})),s.a.createElement(_,n))});t.a=h},XoI5:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r("vDqi"),a=r.n(n).a.create({withCredentials:!0,baseURL:"/api/",headers:{"X-CSRFToken":document.cookie.replace(/(?:(?:^|.*;\s*)csrftoken\s*\=\s*([^;]*).*$)|^.*$/,"$1")}})},Z2Y6:function(e,t,r){"use strict";var n,a=r("q1tI"),i=r.n(a),o=r("5Xg7"),s=r("VCnP"),c=r.n(s),l=r("okNM");function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _=function(e){return i.a.createElement("div",{className:"count__label"},e.children,e.clearable&&i.a.createElement("div",{onClick:e.clearSelect},i.a.createElement("i",{className:"fa fa-times","aria-hidden":"true"})))},h=Object(l.a)(n=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=f(this,d(t).call(this,e))).clearSelect=function(e){e.stopPropagation(),n.props.onChange([])},n.makeLabel=function(e){var t=e.placeholderButtonLabel,r=e.value;return r?Array.isArray(r)?0===r.length?i.a.createElement(_,{clearable:!1},t):1===r.length?i.a.createElement(_,{clearable:!0,clearSelect:n.clearSelect},r[0].label):i.a.createElement(_,{clearable:!0,clearSelect:n.clearSelect},"".concat(r.length," ",gettext("selected"))):i.a.createElement(_,{clearable:!1},r.label):i.a.createElement(_,{clearable:!1},t)},n}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(t,i.a.Component),r=t,(n=[{key:"render",value:function(){return i.a.createElement(c.a,p({},this.props,{placeholder:gettext("Search"),placeholderButtonLabel:this.props.placeholder,getDropdownButtonLabel:this.makeLabel,components:{MenuList:o.a}}))}}])&&m(r.prototype,n),a&&m(r,a),t}())||n;t.a=h},tnXs:function(e,t,r){"use strict";var n=r("q1tI"),i=r.n(n);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],0<=t.indexOf(r)||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=function(e){function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=l(this,u(r).call(this,e))).state={folded:!1},t}var t,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(r,i.a.Component),t=r,(n=[{key:"toggleFolded",value:function(){this.setState({folded:!this.state.folded})}},{key:"render",value:function(){var e=this,t=this.props,r=t.className,n=s(t,["className"]),a=this.state.folded?"fa-chevron-right":"fa-chevron-left";return i.a.createElement("div",o({className:"folding-sidebar "+(r||"")},n),!this.state.folded&&i.a.createElement(i.a.Fragment,null,this.props.children),i.a.createElement("div",{className:"folding-sidebar__trigger",onClick:function(){return e.toggleFolded()}},i.a.createElement("i",{key:a},i.a.createElement("span",{className:"fa "+a}))))}}])&&c(t.prototype,n),a&&c(t,a),r}();t.a=m}},[["9KAa",0,1]]]);