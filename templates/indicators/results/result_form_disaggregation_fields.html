{% load widget_tweaks %}
{% load i18n %}
{# disaggregation fields in result_form_modal.html #}
{# TODO: update design, test functionality #}
{# values supercede labels, so show labels if not values #}
{% if standard_disaggregation_labels and not standard_disaggregation_values %}
<fieldset class="">
    <div
        id="disagg_toggle"
        class="accordion-toggle btn btn-toggle btn-link"
        data-toggle="collapse"
        data-target="#standardDisagg"
        aria-expanded="false"
        aria-controls="standardDisagg">
        <!-- Need the div to make ensure rotating symbol doesn't push text to the right -->
        <div class="div-expand-symbol"><i class="fas fa-caret-right"></i></div>
        {% trans "Standard disaggregations" %}
    </div>
    <div class="collapse" id="standardDisagg">
        <table class="table table-sm table-hover table-striped">
            <tr>
                <th>{% trans "Disaggregation level" %}</th>
                <th>{% trans "Actuals" %}</th>
            </tr>
            {% for item in standard_disaggregation_labels %}
                <tr>
                    <td>{{ item.label }}</td>
                    <td>
                        <input type="number" min="0"
                            class="form-control form-control-sm"
                            name="{{ item.id }}"
                            value="">
                    </td>
                </tr>
            {% endfor %}
        </table>
    </div>
{% elif not standard_disaggregation_labels and not standard_disaggregation_values %}
    {# if no standard labels or values exist inform user of setup error #}
    <h4>{% trans "Standard disaggregation levels not entered" %}</h4>
    <p>{% trans "Standard disaggregations are entered by the administrator for the entire organizations.  If you are not seeing any here, please contact your system administrator." %}</p>
{% endif %}
{# values supercede labels so check for values first: #}
{% if custom_disaggregation_values %}
<fieldset class="">
    <div
        class="accordion-toggle btn btn-toggle btn-link"
        data-toggle="collapse"
        data-target="#existingDisagg"
        aria-expanded="false"
        aria-controls="existingDisagg">
        <div class="div-expand-symbol"><i class="fas fa-caret-right"></i></div>
        {% trans "Existing disaggregations" %}
    </div>
    <div class="collapse" id="existingDisagg">
        <table class="table table-sm table-hover table-striped">
            <tr>
                <th>{% trans "Disaggregation level" %}</th>
                <th>{% trans "Actuals" %}</th>
            </tr>
            {% for item in custom_disaggregation_values %}
            <tr>
                <td>{{ item.disaggregation_label.label }}</td>
                <td>
                    <input type="number" min="0"
                                         class="form-control form-controm-sm"
                                         name="{{ item.disaggregation_label.id }}"
                                         value="{{ item.value }}">
                </td>
            </tr>
            {% endfor %}
        </table>
    </div>
</fieldset>
{% elif custom_disaggregation_labels %}
{# no custom values check for custom labels #}
<fieldset class="">
    <div
        class="accordion-toggle btn btn-toggle btn-link"
        data-toggle="collapse"
        data-target="#newDisagg"
        aria-expanded="false"
        aria-controls="newDisagg">
        <div class="div-expand-symbol"><i class="fas fa-caret-right"></i></div>
        {% trans "New disaggregations" %}
    </div>
    <div class="collapse" id="newDisagg">
        <table class="table table-sm table-hover table-striped">
            <tr>
                <th>{% trans "Disaggregation level" %}</th>
                <th>{% trans "Actuals" %}</th>
            </tr>
            {% for item in custom_disaggregation_labels %}
            <tr>
                <td>{{ item.label }}</td>
                <td>
                    <input type="number" min="0"
                                         class="form-control form-control-sm"
                                         name="{{ item.id }}"
                                         value="">
                </td>
            </tr>
            {% endfor %}
        </table>
    </div>
    </div>
</fieldset>
{% endif %}
{# no need to msg if no custom labels or values, as this is a normal program setup condition #}

{% if standard_disaggregation_values %}
<fieldset class="">
    <div class="card">
        <div
            class="accordion-toggle btn btn-toggle btn-link"
            data-toggle="collapse"
            data-target="#existingStandardDisagg"
            aria-expanded="false"
            aria-controls="existingStandardDisagg">
            <div class="div-expand-symbol"><i class="fas fa-caret-right"></i></div>
            {% trans "Existing standard disaggregations" %}
        </div>
        <div class="collapse" id="existingStandardDisagg">
            <table class="table table-sm table-hover table-striped">
                <tr>
                    <th>{% trans "Disaggregation level" %}</th>
                    <th>{% trans "Actuals" %}</th>
                </tr>
                {% for item in standard_disaggregation_values %}
                <tr>
                    <td>{{ item.disaggregation_label.label }}</td>
                    <td>
                        <input type="number" min="0"
                            class="form-control form-control-sm"
                            name="{{ item.disaggregation_label.id }}"
                            value="{{ item.value }}">
                    </td>
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>
</fieldset>
{% endif %}
